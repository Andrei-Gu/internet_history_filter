# internet_history_filter

Работникам организации предоставлялся доступ в сеть Интернет, но при этом локальные нормативные документы запрещали посещать сайты, которые напрямую не связанны с исполнением должностных обязанностей.
Например, за посещение с рабочего ПК сайта [**ЦБ РФ**][1] никаких санкций к работнику не применялось. А вот за просмотр [**портала об индуизме (санатана-дхарме) и культуре Индии**][2] могли скорректировать размер премии.

Для выявления подобных фактов проводился анализ выгрузки посещенных работником сайтов. Выгрузка поступала в виде .csv файла с именами полей:
"@timestamp","src_ip",realm,"auth_user","response_code","http_method","bytes_from_client","bytes_to_client","media_type",url  
"Jan 17, 2021 @ 20:50:49.000","10.xxx.xxx.xxx",SomeRealm,imxxxxxxxx,200,GET,354,318,"text/plain","http://detectportal.firefox.com/success.txt?ipv4"  
"Jan 17, 2021 @ 18:01:11.000","10.xxx.xxx.xxx",SomeRealm,imxxxxxxxx,403,GET,141,"3,079",,"https://armmf.adobe.com/arm-manifests/win/Acrobat10Manifest3.msi"  
"Jan 17, 2021 @ 15:47:38.000","10.xxx.xxx.xxx",SomeRealm,imxxxxxxxx,200,CONNECT,"1,354","1,207",,"api.kontur.ru:443"  
"Jan 16, 2021 @ 11:25:33.000","10.xxx.xxx.xxx",SomeRealm,imxxxxxxxx,403,GET,904,"3,392",,"https://ad.mail.ru/static/ads-async.js"  

Так как какой-либо предварительной фильтрации не производилось, то такие выгрузки могли содержать и 40, и 60 тысяч строк. Чтобы ускорить процесс анализа и повысить его качество мною был написан данный скрипт, который позволяет:
- считывать из .txt файла ключи фильтрации, которые задает проверяющий;
- игнорировать те ссылки, которые точно НЕ интересуют проверяющего, например, относятся к [**КонсультантПлюс**][3];
- собрать в отдельный файл ссылки, которые точно интересуют проверяющего, например, [**магазин интерьера и декора**][4];
- собрать в отдельный файл ссылки, которые не соответствуют предыдущим пунктам и являются "подозрительными".

При этом, в итоговые файлы сохраняется только необходимая проверяющему информация: дата, время и сама ссылка.

[1]: https://www.cbr.ru/
[2]: https://satyam-shivam-sundaram.org/
[3]: https://www.consultant.ru/
[4]: https://idcollection.ru/catalogue/elementy-dekora/
